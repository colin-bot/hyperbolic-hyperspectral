# Physicochemical trait regression from hyperspectral data

This repository contains code used for the thesis *Euclid vs. Lorentz: deep geometric regression models for hyperspectral images of fruit* by Colin Bot. It contains an implementation of a method for prediction kiwifruit sweetness and firmness. The dataset the research was based on was created by Aneesh Chauhan and Lydia Meesters at Wageningen University & Research. This data is not included in the repository.

To run the codebase, the packages in `requirements.txt` first need to be installed (when running on the Snellius cluster one can also run `install.sh`). To process the raw dataset, `data.py` can be used. For the Lorentzian hyperbolic models, the `HyperbolicCV` library (which can be found [here](https://github.com/kschwethelm/HyperbolicCV)) needs to be installed at the same level as this repository, followed by running `update_HyperbolicCV.sh` to make it compatible with the hyperspectral data. To test the data on another hyperspectral dataset (for classification), the `deephs_fruit` (which can be found [here](https://github.com/cogsys-tuebingen/deephs_fruit)) needs to be installed at the same level as this repository, followed by downloading their dataset which is explained in their ReadME (for use on Snellius, `download_alt_data.sh` may be useful).

The main files used for running this codebase are `train_euc_hypll.py` for Euclidean- and Poincar√©-based neural models, `train_hypcv.py` for Lorentz-based neural models, and `baselines.sh` for the traditional machine learning baselines. The corresponding `.sh` files run the code on the Snellius cluster. The `hybrid_hypll.py` and `hybrid_hypcv.py` files can be used to test hybrid models.
